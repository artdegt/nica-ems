FROM gradle:jdk15 as builder
COPY src ./src
COPY build.gradle.kts ./build.gradle.kts
COPY settings.gradle.kts ./settings.gradle.kts
RUN gradle installDist

FROM azul/zulu-openjdk:17
EXPOSE 8080:8080
COPY --from=builder /home/gradle/build/install/nica-emd/ /app/
COPY --from=builder /home/gradle/build/processedResources/jvm/main/ /app/resources/main
WORKDIR /app/bin
CMD ["./nica-emd"]
